<!DOCTYPE HTML>
<html lang="en">
  <head>
    <title>International Space Station Tracker</title>
    <meta charset="utf-8">
    <style type="text/css">
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      body {
        background: #000 url('/issglobe/loading.gif') center center no-repeat;
        color: #fff;
        font-family: sans-serif;
        font-size: 13px;
        line-height: 20px;
      }
      #container {
        width: 100%;
        height: 100%;
      }
      #info {
        font-size: 11px;
        position: absolute;
        bottom: 5px;
        background-color: rgba(0,0,0,0.8);
        border-radius: 3px;
        right: 10px;
        padding: 10px;
      }
      #info a {
        color: #aaa;
        text-decoration: none;
      }
      #info a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <div id="container"></div>
    <div id="info">
      <strong>International Space Station Tracker</strong><br>
      Live data provided by <a href="http://api.open-notify.org/iss-now.json" target="_blank">Open Notify</a>
    </div>
    <script type="text/javascript" src="/issglobe/third-party/Detector.js"></script>
    <script type="text/javascript" src="/issglobe/third-party/three.min.js"></script>
    <script type="text/javascript" src="/issglobe/third-party/Tween.js"></script>
    <script type="text/javascript" src="/issglobe/globe.js"></script>
    <script type="text/javascript">
      if (!Detector.webgl) {
        Detector.addGetWebGLMessage();
      } else {
        var container = document.getElementById('container');
        // Pass the correct image directory so that world.jpg loads correctly.
        var globe = new DAT.Globe(container, { imgDir: '/issglobe/' });
        globe.animate();
        document.body.style.backgroundImage = 'none'; // remove loading image

        // Optional: log a message every 5 seconds to check for ISS updates
        setInterval(function() {
          console.log('ISS marker position:', globe.scene.children.filter(function(child) {
            return child && child.material && child.material.color && child.material.color.getHex() === 0xff0000;
          }));
        }, 5000);
      }
    </script>
  </body>
</html>
